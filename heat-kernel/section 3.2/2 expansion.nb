(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     54462,       1229]
NotebookOptionsPosition[     52944,       1172]
NotebookOutlinePosition[     53298,       1188]
CellTagsIndexPosition[     53255,       1185]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Sigma]1", ",", "\[Sigma]2", ",", "\[Sigma]3"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   FractionBox[
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"2", 
       SuperscriptBox["k", "2"]}]}]], "k"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   FractionBox[
    SuperscriptBox["b", "2"], 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox["b", "2"]}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sub", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"\[Tau]", "\[Rule]", 
          RowBox[{
           FractionBox[
            SqrtBox[
             RowBox[{
              SuperscriptBox["b", "4"], "+", 
              SuperscriptBox["p", "2"]}]], 
            RowBox[{"b", " ", "p"}]], "w"}]}]},
        {
         RowBox[{"d\[Tau]", "\[Rule]", 
          RowBox[{
           FractionBox[
            RowBox[{"b", " ", "p"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox["b", "4"], "+", 
              SuperscriptBox["p", "2"]}]]], "dw"}]}]},
        {
         RowBox[{"d\[Tau]\[Tau]", "\[Rule]", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"b", " "}], "2"], 
             SuperscriptBox["p", "2"]}], 
            RowBox[{
             SuperscriptBox["b", "4"], "+", 
             SuperscriptBox["p", "2"]}]], "dww"}]}]},
        {
         RowBox[{"\[Sigma]", "\[Rule]", 
          RowBox[{
           FractionBox["2", "\[Pi]"], " ", 
           RowBox[{"EllipticK", "[", 
            SuperscriptBox["k", "2"], "]"}], "r"}]}]},
        {
         RowBox[{"d\[Sigma]", "\[Rule]", " ", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             FractionBox["2", "\[Pi]"], " ", 
             RowBox[{"EllipticK", "[", 
              SuperscriptBox["k", "2"], "]"}]}]], "dr"}]}]},
        {
         RowBox[{"d\[Sigma]\[Sigma]", "\[Rule]", " ", 
          RowBox[{
           FractionBox["1", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               FractionBox["2", "\[Pi]"], " ", 
               RowBox[{"EllipticK", "[", 
                SuperscriptBox["k", "2"], "]"}]}], ")"}], "2"]], "drr"}]}]}
       }], ")"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dsq", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Cos", "[", "r", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{"drr", "+", "dww"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dbar", "=", 
   RowBox[{
    RowBox[{"\[Sigma]1", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "r", "]"}], " ", "dr"}], "+", 
       FractionBox[
        RowBox[{"Sin", "[", "r", "]"}], "2"]}], ")"}]}], "+", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "r", "]"}], "\[Sigma]2", " ", "dw"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6636794194935703`*^9, 3.663679478692232*^9}, {
   3.663679537140882*^9, 3.663679559953236*^9}, {3.663679655158661*^9, 
   3.6636796710321836`*^9}, {3.663679946905884*^9, 3.663679947098192*^9}, 
   3.663679979166072*^9, {3.6636801752562933`*^9, 3.6636801762041597`*^9}, {
   3.663768620819824*^9, 3.663768621159144*^9}, 3.663781311151334*^9, 
   3.663781759161537*^9, {3.6637817950554743`*^9, 3.663781821659573*^9}, {
   3.664861395400034*^9, 3.664861404400935*^9}, {3.667663889184524*^9, 
   3.667664061134429*^9}, {3.667992500016156*^9, 3.6679925002161617`*^9}, {
   3.6679965931371193`*^9, 3.667996603160915*^9}, {3.667998318620122*^9, 
   3.6679983409685593`*^9}, {3.667998384660364*^9, 3.6679984141306868`*^9}, {
   3.667999737558834*^9, 3.6679997377544622`*^9}, {3.6680000088381453`*^9, 
   3.668000011459783*^9}, {3.668000283984885*^9, 3.668000294376133*^9}, {
   3.668003993577977*^9, 3.668004016004899*^9}, {3.669395842011382*^9, 
   3.6693958954353333`*^9}, {3.669402012470903*^9, 3.669402037790021*^9}, 
   3.6694045845729017`*^9, {3.669404621935829*^9, 3.669404628155511*^9}, {
   3.669435973935684*^9, 3.6694360312402887`*^9}, {3.669473977150691*^9, 
   3.669473983291916*^9}, {3.6694812849987288`*^9, 3.669481289101705*^9}, {
   3.669481442750957*^9, 3.669481462783616*^9}, {3.6694815187456408`*^9, 
   3.669481525611104*^9}, {3.669481746989571*^9, 3.669481791231304*^9}, {
   3.669481823372819*^9, 3.669481837578039*^9}, {3.6694818807150784`*^9, 
   3.66948190483821*^9}, {3.669482164378262*^9, 3.669482167611382*^9}, {
   3.669483123567606*^9, 3.669483125364839*^9}, {3.669483316043548*^9, 
   3.6694833429474373`*^9}, {3.669521033884652*^9, 3.6695210407956247`*^9}, 
   3.6695213698678017`*^9, {3.669521425113843*^9, 3.6695214261868763`*^9}, {
   3.669522892015336*^9, 3.669522901937798*^9}, {3.6695230232613783`*^9, 
   3.669523023735166*^9}, {3.669525256698277*^9, 3.6695252693100443`*^9}, {
   3.669565767390295*^9, 3.669565811701067*^9}, {3.669566200596805*^9, 
   3.6695662123563957`*^9}, {3.66956629894772*^9, 3.669566327922468*^9}, 
   3.669567099996847*^9, {3.669567244698246*^9, 3.669567248570773*^9}, 
   3.669609439665454*^9, {3.6696140120005627`*^9, 3.6696140348172493`*^9}, {
   3.6696187228973913`*^9, 3.669618729287167*^9}, {3.670128105738302*^9, 
   3.6701281124382467`*^9}}],

Cell[CellGroupData[{

Cell["Metric", "Subsection",
 CellChangeTimes->{{3.4535844404117928`*^9, 3.4535844415037603`*^9}, 
   3.643047313599284*^9, {3.6430478198430023`*^9, 3.643047838586029*^9}, {
   3.644793368090185*^9, 3.6447933743295317`*^9}, {3.6447934424755917`*^9, 
   3.6447935130696793`*^9}, {3.6447939337389174`*^9, 
   3.6447940231289577`*^9}, {3.644794183606655*^9, 3.644794187463924*^9}, {
   3.644794394368672*^9, 3.6447944313764143`*^9}, {3.644795906153263*^9, 
   3.644795912764584*^9}, {3.662882104170529*^9, 3.6628821267278843`*^9}, {
   3.664040266045627*^9, 3.6640402667107677`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["k", "2"]}], 
       SuperscriptBox[
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"EllipticK", "[", 
              SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
          SuperscriptBox["k", "2"]}], "]"}], "2"]], 
      RowBox[{"(", GridBox[{
         {
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"2", " ", 
              RowBox[{"EllipticK", "[", 
               SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], ")"}], "2"], 
          "0"},
         {"0", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             SqrtBox[
              RowBox[{
               SuperscriptBox["b", "4"], "+", 
               SuperscriptBox["p", "2"]}]], 
             RowBox[{"b", " ", "p"}]], ")"}], "2"]}
        }], ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"JacobiCN", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"EllipticK", "[", 
              SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
          SuperscriptBox["k", "2"]}], "]"}], 
        RowBox[{"-", "2"}]], "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "r", "]"}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", "r", "]"}], "2"], 
             RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
           SuperscriptBox["k", "2"]}], "+", 
          RowBox[{"unknown", " ", 
           SuperscriptBox["k", "4"]}]}], ")"}], 
        RowBox[{"-", "2"}]]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], "&"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], "]"}], "0"},
       {"0", 
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}]}
      }], ")"}], "\[Equal]", 
    RowBox[{"(", GridBox[{
       {
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "r", "]"}], "2"]], "0"},
       {"0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "r", "]"}], "2"]]}
      }], ")"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], "0"},
       {"0", 
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}]}
      }], ")"}], "\[Equal]", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         FractionBox["1", "2"]}], "0"},
       {"0", 
        RowBox[{
         FractionBox["3", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "r", "]"}], "2"]}]], "-", 
         FractionBox["1", "2"]}]}
      }], ")"}]}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"Det", "[", "tmp", "]"}], ",", "0"}], "]"}], "\[Equal]", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "r", "]"}], "4"]]}], "//.", "sub"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SeriesCoefficient", "[", 
         RowBox[{
          RowBox[{"Det", "[", "tmp", "]"}], ",", "2"}], "]"}], "\[Equal]", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "r", "]"}], "2"]], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["3", 
            RowBox[{"2", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "r", "]"}], "2"]}]], "-", "1"}], ")"}]}]}], 
       "//.", "sub"}], "//", "TrigToExp"}], "//", "FullSimplify"}], "//", 
    "PowerExpand"}], "//", "FullSimplify"}], "//", "FullSimplify"}]}], "Input",\

 CellChangeTimes->{{3.6675478795162153`*^9, 3.667548017654673*^9}, {
   3.667548080418707*^9, 3.6675481900198*^9}, {3.667548256042233*^9, 
   3.6675482721822166`*^9}, {3.667548313393072*^9, 3.66754835567194*^9}, {
   3.667548410623908*^9, 3.667548413817441*^9}, 3.6675484671297817`*^9, {
   3.667548614093027*^9, 3.6675486941656227`*^9}, {3.667548799672258*^9, 
   3.667548819158842*^9}, {3.667548881553379*^9, 3.667548885442479*^9}, {
   3.667548954632691*^9, 3.667548957048667*^9}, 3.66754899626414*^9, {
   3.6677475348773518`*^9, 3.6677475622639914`*^9}, {3.667992506027508*^9, 
   3.667992516213355*^9}, 3.667992608329385*^9, {3.66799270644932*^9, 
   3.6679928247207623`*^9}, {3.667992943967311*^9, 3.66799306230296*^9}, {
   3.667993113500558*^9, 3.6679932506357803`*^9}, {3.667999807000143*^9, 
   3.667999807702282*^9}, {3.668073208757069*^9, 3.668073269916667*^9}, {
   3.668073369020184*^9, 3.6680733727213507`*^9}, {3.66807344991181*^9, 
   3.668073451215829*^9}, {3.6693959991525297`*^9, 3.6693960010261993`*^9}, {
   3.6693960325273733`*^9, 3.6693960335213137`*^9}, {3.6693968113928337`*^9, 
   3.6693968116900663`*^9}, {3.66939686444624*^9, 3.669396903805684*^9}, {
   3.669397286553915*^9, 3.669397303611751*^9}, {3.669397371097522*^9, 
   3.669397377497397*^9}, {3.6693974426483107`*^9, 3.669397486681266*^9}, {
   3.669397528219898*^9, 3.669397533118596*^9}, {3.6693977819066963`*^9, 
   3.6693978079338417`*^9}, {3.669397935268093*^9, 3.669398011781851*^9}, {
   3.669398123811675*^9, 3.669398145388936*^9}, {3.6693982011987333`*^9, 
   3.669398281974145*^9}, {3.669398322984288*^9, 3.66939841022611*^9}, 
   3.6693985968112507`*^9, {3.6693989032760963`*^9, 3.669398945812046*^9}, {
   3.6693991294926443`*^9, 3.669399129706345*^9}, {3.6693991959567957`*^9, 
   3.669399348351074*^9}, {3.6693994007529907`*^9, 3.6693994034159613`*^9}, {
   3.6693995718652887`*^9, 3.6693996440659*^9}, {3.669400055308405*^9, 
   3.6694000634870577`*^9}, {3.669400183570713*^9, 3.669400188465289*^9}, {
   3.6694002339827957`*^9, 3.669400275973377*^9}, {3.6694003580242167`*^9, 
   3.6694004475847282`*^9}, {3.669481279135413*^9, 3.669481282546069*^9}, {
   3.669481977376296*^9, 3.669481995822489*^9}, {3.669482044362018*^9, 
   3.669482048141593*^9}, {3.669483117472453*^9, 3.669483119209835*^9}, {
   3.669483151135483*^9, 3.669483191060622*^9}, 3.669483250927752*^9, {
   3.6694832836970453`*^9, 3.669483290624902*^9}, {3.669523103333124*^9, 
   3.66952310534179*^9}, {3.669566449665781*^9, 3.6695664513178673`*^9}, {
   3.669566509856559*^9, 3.669566790556404*^9}, {3.669566861466655*^9, 
   3.669566946875461*^9}, {3.6710088981497517`*^9, 3.67100894324503*^9}, {
   3.671009007776314*^9, 3.671009038384441*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6693982160901546`*^9, 3.6693982241827*^9}, {
   3.6693982583766403`*^9, 3.6693982890458603`*^9}, {3.669398336782505*^9, 
   3.6693983496275387`*^9}, {3.669398407141865*^9, 3.669398410657606*^9}, 
   3.66939859728339*^9, 3.66939892227315*^9, 3.669398967043623*^9, 
   3.669399130149824*^9, {3.669399199775868*^9, 3.669399269683649*^9}, {
   3.6693993427834997`*^9, 3.66939934895198*^9}, 3.669399404069663*^9, {
   3.669399615200449*^9, 3.669399634850875*^9}, 3.669400073537895*^9, {
   3.6694002366004744`*^9, 3.6694002763131*^9}, {3.669400358609429*^9, 
   3.66940044796838*^9}, 3.66947343526667*^9, 3.669481744089973*^9, 
   3.669481796326044*^9, 3.669481929430097*^9, 3.6694820069105453`*^9, 
   3.669482048548729*^9, {3.6694831761141243`*^9, 3.669483192325371*^9}, 
   3.669483285545855*^9, 3.669483327198306*^9, 3.66952137271209*^9, 
   3.669521431708952*^9, {3.669523096981151*^9, 3.6695231056917267`*^9}, {
   3.669566625463542*^9, 3.669566644271297*^9}, {3.669566692621718*^9, 
   3.669566727118408*^9}, {3.669566758792911*^9, 3.669566791027946*^9}, {
   3.669566871889399*^9, 3.669566947372423*^9}, 3.669567131099918*^9, 
   3.669609519696821*^9, 3.6696137496976223`*^9, 3.6696140795452538`*^9, 
   3.669624896563336*^9, {3.671008931201901*^9, 3.67100894373446*^9}, {
   3.671009008337698*^9, 3.671009040621338*^9}, 3.671033795270114*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6693982160901546`*^9, 3.6693982241827*^9}, {
   3.6693982583766403`*^9, 3.6693982890458603`*^9}, {3.669398336782505*^9, 
   3.6693983496275387`*^9}, {3.669398407141865*^9, 3.669398410657606*^9}, 
   3.66939859728339*^9, 3.66939892227315*^9, 3.669398967043623*^9, 
   3.669399130149824*^9, {3.669399199775868*^9, 3.669399269683649*^9}, {
   3.6693993427834997`*^9, 3.66939934895198*^9}, 3.669399404069663*^9, {
   3.669399615200449*^9, 3.669399634850875*^9}, 3.669400073537895*^9, {
   3.6694002366004744`*^9, 3.6694002763131*^9}, {3.669400358609429*^9, 
   3.66940044796838*^9}, 3.66947343526667*^9, 3.669481744089973*^9, 
   3.669481796326044*^9, 3.669481929430097*^9, 3.6694820069105453`*^9, 
   3.669482048548729*^9, {3.6694831761141243`*^9, 3.669483192325371*^9}, 
   3.669483285545855*^9, 3.669483327198306*^9, 3.66952137271209*^9, 
   3.669521431708952*^9, {3.669523096981151*^9, 3.6695231056917267`*^9}, {
   3.669566625463542*^9, 3.669566644271297*^9}, {3.669566692621718*^9, 
   3.669566727118408*^9}, {3.669566758792911*^9, 3.669566791027946*^9}, {
   3.669566871889399*^9, 3.669566947372423*^9}, 3.669567131099918*^9, 
   3.669609519696821*^9, 3.6696137496976223`*^9, 3.6696140795452538`*^9, 
   3.669624896563336*^9, {3.671008931201901*^9, 3.67100894373446*^9}, {
   3.671009008337698*^9, 3.671009040621338*^9}, 3.671033795317011*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6693982160901546`*^9, 3.6693982241827*^9}, {
   3.6693982583766403`*^9, 3.6693982890458603`*^9}, {3.669398336782505*^9, 
   3.6693983496275387`*^9}, {3.669398407141865*^9, 3.669398410657606*^9}, 
   3.66939859728339*^9, 3.66939892227315*^9, 3.669398967043623*^9, 
   3.669399130149824*^9, {3.669399199775868*^9, 3.669399269683649*^9}, {
   3.6693993427834997`*^9, 3.66939934895198*^9}, 3.669399404069663*^9, {
   3.669399615200449*^9, 3.669399634850875*^9}, 3.669400073537895*^9, {
   3.6694002366004744`*^9, 3.6694002763131*^9}, {3.669400358609429*^9, 
   3.66940044796838*^9}, 3.66947343526667*^9, 3.669481744089973*^9, 
   3.669481796326044*^9, 3.669481929430097*^9, 3.6694820069105453`*^9, 
   3.669482048548729*^9, {3.6694831761141243`*^9, 3.669483192325371*^9}, 
   3.669483285545855*^9, 3.669483327198306*^9, 3.66952137271209*^9, 
   3.669521431708952*^9, {3.669523096981151*^9, 3.6695231056917267`*^9}, {
   3.669566625463542*^9, 3.669566644271297*^9}, {3.669566692621718*^9, 
   3.669566727118408*^9}, {3.669566758792911*^9, 3.669566791027946*^9}, {
   3.669566871889399*^9, 3.669566947372423*^9}, 3.669567131099918*^9, 
   3.669609519696821*^9, 3.6696137496976223`*^9, 3.6696140795452538`*^9, 
   3.669624896563336*^9, {3.671008931201901*^9, 3.67100894373446*^9}, {
   3.671009008337698*^9, 3.671009040621338*^9}, 3.6710337953242407`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6693982160901546`*^9, 3.6693982241827*^9}, {
   3.6693982583766403`*^9, 3.6693982890458603`*^9}, {3.669398336782505*^9, 
   3.6693983496275387`*^9}, {3.669398407141865*^9, 3.669398410657606*^9}, 
   3.66939859728339*^9, 3.66939892227315*^9, 3.669398967043623*^9, 
   3.669399130149824*^9, {3.669399199775868*^9, 3.669399269683649*^9}, {
   3.6693993427834997`*^9, 3.66939934895198*^9}, 3.669399404069663*^9, {
   3.669399615200449*^9, 3.669399634850875*^9}, 3.669400073537895*^9, {
   3.6694002366004744`*^9, 3.6694002763131*^9}, {3.669400358609429*^9, 
   3.66940044796838*^9}, 3.66947343526667*^9, 3.669481744089973*^9, 
   3.669481796326044*^9, 3.669481929430097*^9, 3.6694820069105453`*^9, 
   3.669482048548729*^9, {3.6694831761141243`*^9, 3.669483192325371*^9}, 
   3.669483285545855*^9, 3.669483327198306*^9, 3.66952137271209*^9, 
   3.669521431708952*^9, {3.669523096981151*^9, 3.6695231056917267`*^9}, {
   3.669566625463542*^9, 3.669566644271297*^9}, {3.669566692621718*^9, 
   3.669566727118408*^9}, {3.669566758792911*^9, 3.669566791027946*^9}, {
   3.669566871889399*^9, 3.669566947372423*^9}, 3.669567131099918*^9, 
   3.669609519696821*^9, 3.6696137496976223`*^9, 3.6696140795452538`*^9, 
   3.669624896563336*^9, {3.671008931201901*^9, 3.67100894373446*^9}, {
   3.671009008337698*^9, 3.671009040621338*^9}, 3.671033795330468*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bosons: expansion operators", "Subsection",
 CellChangeTimes->{{3.4535844404117928`*^9, 3.4535844415037603`*^9}, 
   3.643047313599284*^9, {3.6430478198430023`*^9, 3.643047838586029*^9}, {
   3.644793368090185*^9, 3.6447933743295317`*^9}, {3.6447934424755917`*^9, 
   3.6447935130696793`*^9}, {3.646369490692437*^9, 3.646369494542533*^9}, 
   3.646466457334859*^9, {3.6464670754941463`*^9, 3.646467165301708*^9}, {
   3.6625746424641247`*^9, 3.662574647009775*^9}, {3.662706095187007*^9, 
   3.662706131059403*^9}, {3.663782135208894*^9, 3.6637821636292753`*^9}, {
   3.667549340818646*^9, 3.6675493437926407`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "O0", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"JacobiCN", "[", 
             RowBox[{"\[Sigma]", ",", 
              SuperscriptBox["k", "2"]}], "]"}], "2"], 
           RowBox[{"1", "-", 
            SuperscriptBox["k", "2"]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d\[Tau]\[Tau]"}], "-", "d\[Sigma]\[Sigma]"}], 
           ")"}]}], "/.", "sub"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"JacobiCN", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"EllipticK", "[", 
                SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
            SuperscriptBox["k", "2"]}], "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "r", "]"}], "-", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", "r", "]"}], "2"], 
               RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{"unknown", " ", 
             SuperscriptBox["k", "4"]}]}], ")"}]}], "}"}]}], "//", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], "&"}]}], "//", 
      "PowerExpand"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{"-", " ", "Dsq"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "2"}], "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", "r", "]"}], "2"], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "r", "]"}], "2"]}], " ", "drr"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "r", "]"}], "2"]}], ")"}], "dww"}]}], 
       ")"}]}]}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.663674770776667*^9, 3.663674846561812*^9}, {
   3.663675009210186*^9, 3.6636751182649097`*^9}, {3.6636793978023853`*^9, 
   3.663679417471847*^9}, {3.663679481161501*^9, 3.6636795339886293`*^9}, {
   3.6636796792000732`*^9, 3.663679720470022*^9}, {3.6636798118608*^9, 
   3.663679840914425*^9}, {3.663679916206037*^9, 3.663679918043882*^9}, {
   3.663680134466712*^9, 3.6636802236962843`*^9}, {3.6636803657432947`*^9, 
   3.66368036585928*^9}, {3.663768692729141*^9, 3.663768730269141*^9}, {
   3.6637813111602297`*^9, 3.663781311164133*^9}, {3.663781364521043*^9, 
   3.663781408266892*^9}, {3.663781759172381*^9, 3.66378175918688*^9}, {
   3.6637817950662823`*^9, 3.6637818120325212`*^9}, {3.663781848404751*^9, 
   3.663781852621092*^9}, 3.6637819612257147`*^9, {3.667549358211488*^9, 
   3.6675493766298027`*^9}, {3.66754956400146*^9, 3.6675495975613213`*^9}, {
   3.6675496887064457`*^9, 3.6675496968639383`*^9}, {3.667549739642297*^9, 
   3.6675497755211487`*^9}, {3.667549879382414*^9, 3.667549970230867*^9}, {
   3.667550007911808*^9, 3.6675500113318243`*^9}, {3.667550047447369*^9, 
   3.667550064133133*^9}, 3.667550137440819*^9, 3.6675501733610077`*^9, {
   3.667550211168961*^9, 3.6675502271873407`*^9}, {3.667550381356895*^9, 
   3.6675504056051493`*^9}, {3.66755567470057*^9, 3.6675557145243*^9}, 
   3.667555792035755*^9, {3.667995402834785*^9, 3.667995652151586*^9}, {
   3.667995697287881*^9, 3.667995708547701*^9}, {3.667995809555141*^9, 
   3.6679958112779207`*^9}, {3.667996001972687*^9, 3.667996016774737*^9}, {
   3.667996614084556*^9, 3.6679967451144543`*^9}, {3.667996820777787*^9, 
   3.6679969129327793`*^9}, {3.667997047995391*^9, 3.6679970592008457`*^9}, {
   3.667997156746449*^9, 3.667997218553705*^9}, {3.667997326886407*^9, 
   3.667997328424263*^9}, {3.6679973680271683`*^9, 3.667997380815443*^9}, {
   3.667997455367745*^9, 3.6679974569638157`*^9}, {3.6680043285404997`*^9, 
   3.668004330326556*^9}, {3.6680884631486473`*^9, 3.6680884956126328`*^9}, {
   3.6694005267943993`*^9, 3.669400527349366*^9}, {3.669481361509822*^9, 
   3.669481414928644*^9}, {3.669481531126622*^9, 3.669481574224667*^9}, {
   3.669481624113899*^9, 3.6694817152145557`*^9}, {3.6694818090558453`*^9, 
   3.6694818129647713`*^9}, {3.669482141836688*^9, 3.6694822501632433`*^9}, 
   3.669483374716393*^9, {3.669521439334722*^9, 3.6695214569160833`*^9}, {
   3.6695240451227617`*^9, 3.6695241162185707`*^9}, 3.669524176529752*^9, {
   3.669567113848879*^9, 3.6695671228262587`*^9}, {3.6695671571728077`*^9, 
   3.669567195666068*^9}, {3.669567270847625*^9, 3.669567347655751*^9}, {
   3.6695676774563503`*^9, 3.669567682662244*^9}, 3.6695684396229258`*^9, {
   3.669614089992708*^9, 3.66961423428725*^9}, {3.669614273340014*^9, 
   3.669614275610663*^9}, {3.6701281399875193`*^9, 3.670128140140048*^9}, 
   3.6710095624585133`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.669481379924959*^9, 3.6694814154877443`*^9}, {
   3.669481533813676*^9, 3.6694815794895372`*^9}, {3.669481626151692*^9, 
   3.66948164064931*^9}, {3.66948170804852*^9, 3.669481727187213*^9}, {
   3.669481799183754*^9, 3.66948181549994*^9}, 3.6694819372351923`*^9, 
   3.669482020698118*^9, 3.669482051023802*^9, {3.6694821486594763`*^9, 
   3.669482250553144*^9}, {3.6694833307911797`*^9, 3.669483376206105*^9}, {
   3.66952143555473*^9, 3.66952145131069*^9}, 3.6695232715240107`*^9, {
   3.669524092448638*^9, 3.669524111158203*^9}, 3.669524187030307*^9, {
   3.669567123344873*^9, 3.669567210855523*^9}, {3.6695672550209713`*^9, 
   3.669567348017025*^9}, 3.6695676831755953`*^9, 3.66956844002702*^9, 
   3.669609519935504*^9, 3.6696137508055887`*^9, {3.6696140819767103`*^9, 
   3.6696141476907997`*^9}, {3.6696141863208513`*^9, 3.669614235077373*^9}, 
   3.6696142765411654`*^9, 3.6696248967161837`*^9, 3.6710089350550833`*^9, 
   3.6710337953840933`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.669481379924959*^9, 3.6694814154877443`*^9}, {
   3.669481533813676*^9, 3.6694815794895372`*^9}, {3.669481626151692*^9, 
   3.66948164064931*^9}, {3.66948170804852*^9, 3.669481727187213*^9}, {
   3.669481799183754*^9, 3.66948181549994*^9}, 3.6694819372351923`*^9, 
   3.669482020698118*^9, 3.669482051023802*^9, {3.6694821486594763`*^9, 
   3.669482250553144*^9}, {3.6694833307911797`*^9, 3.669483376206105*^9}, {
   3.66952143555473*^9, 3.66952145131069*^9}, 3.6695232715240107`*^9, {
   3.669524092448638*^9, 3.669524111158203*^9}, 3.669524187030307*^9, {
   3.669567123344873*^9, 3.669567210855523*^9}, {3.6695672550209713`*^9, 
   3.669567348017025*^9}, 3.6695676831755953`*^9, 3.66956844002702*^9, 
   3.669609519935504*^9, 3.6696137508055887`*^9, {3.6696140819767103`*^9, 
   3.6696141476907997`*^9}, {3.6696141863208513`*^9, 3.669614235077373*^9}, 
   3.6696142765411654`*^9, 3.6696248967161837`*^9, 3.6710089350550833`*^9, 
   3.671033795471847*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "O1", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"JacobiCN", "[", 
              RowBox[{"\[Sigma]", ",", 
               SuperscriptBox["k", "2"]}], "]"}], "2"], 
            RowBox[{"1", "-", 
             SuperscriptBox["k", "2"]}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d\[Tau]\[Tau]"}], "-", "d\[Sigma]\[Sigma]"}], 
            ")"}]}], "+", "2"}], "/.", "sub"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"JacobiCN", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"EllipticK", "[", 
                SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
            SuperscriptBox["k", "2"]}], "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "r", "]"}], "-", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", "r", "]"}], "2"], 
               RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{"unknown", " ", 
             SuperscriptBox["k", "4"]}]}], ")"}]}], "}"}]}], "//", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], "&"}]}], "//", 
      "PowerExpand"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"-", " ", "Dsq"}], "+", "2"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "2"}], "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", "r", "]"}], "2"], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "r", "]"}], "2"]}], " ", "drr"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "r", "]"}], "2"]}], ")"}], "dww"}]}], 
       ")"}]}]}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.66799755898834*^9, 3.667997561809142*^9}, {
   3.667997997448496*^9, 3.667997998156084*^9}, {3.669524378733206*^9, 
   3.669524381110064*^9}, {3.669567368112722*^9, 3.669567383347454*^9}, {
   3.669567671674756*^9, 3.6695676737134533`*^9}, {3.66956840006364*^9, 
   3.669568419349131*^9}, {3.669614348185913*^9, 3.669614375908828*^9}, 
   3.669614947570697*^9, {3.670128145471043*^9, 3.670128145635263*^9}, 
   3.671009568235753*^9, {3.671011438728347*^9, 3.6710114410252523`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.669567375858584*^9, 3.6695673836427593`*^9}, 
   3.669567674261334*^9, {3.669568405341811*^9, 3.669568419692874*^9}, 
   3.669609520079461*^9, 3.669613750927494*^9, {3.669614349278965*^9, 
   3.6696143764302483`*^9}, 3.6696248968475637`*^9, 3.6710089352162933`*^9, 
   3.671011441727598*^9, 3.6710337955211287`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.669567375858584*^9, 3.6695673836427593`*^9}, 
   3.669567674261334*^9, {3.669568405341811*^9, 3.669568419692874*^9}, 
   3.669609520079461*^9, 3.669613750927494*^9, {3.669614349278965*^9, 
   3.6696143764302483`*^9}, 3.6696248968475637`*^9, 3.6710089352162933`*^9, 
   3.671011441727598*^9, 3.6710337955306997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "O2", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"JacobiCN", "[", 
              RowBox[{"\[Sigma]", ",", 
               SuperscriptBox["k", "2"]}], "]"}], "2"], 
            RowBox[{"1", "-", 
             SuperscriptBox["k", "2"]}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d\[Tau]\[Tau]"}], "-", "d\[Sigma]\[Sigma]"}], 
            ")"}]}], "+", "2", "-", 
          RowBox[{"2", 
           FractionBox[
            RowBox[{
             SuperscriptBox["k", "2"], 
             SuperscriptBox[
              RowBox[{"JacobiCN", "[", 
               RowBox[{"\[Sigma]", ",", 
                SuperscriptBox["k", "2"]}], "]"}], "4"]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["k", "2"]}]]}]}], "/.", "sub"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"JacobiCN", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"EllipticK", "[", 
                SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
            SuperscriptBox["k", "2"]}], "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "r", "]"}], "-", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", "r", "]"}], "2"], 
               RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{"unknown", " ", 
             SuperscriptBox["k", "4"]}]}], ")"}]}], "}"}]}], "//", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], "&"}]}], "//", 
      "PowerExpand"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"-", "Dsq"}], "+", "2"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "2"}], "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", "r", "]"}], "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "r", "]"}], "2"]}], "drr"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "r", "]"}], "2"]}], ")"}], " ", "dww"}], "-", 
        
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "r", "]"}], "2"]}]}], ")"}]}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.663674770776667*^9, 3.663674846561812*^9}, {
   3.663674876611135*^9, 3.663674883387784*^9}, {3.663675138619706*^9, 
   3.663675152085959*^9}, {3.663679501127738*^9, 3.663679505350048*^9}, {
   3.663679821479298*^9, 3.66367982885448*^9}, {3.663680376779008*^9, 
   3.663680385577805*^9}, {3.663768844674008*^9, 3.663768853484376*^9}, {
   3.6637813111738043`*^9, 3.663781311179123*^9}, {3.663781413842297*^9, 
   3.663781427787911*^9}, {3.663781759195353*^9, 3.663781759207334*^9}, {
   3.663781795092683*^9, 3.663781812055264*^9}, {3.663781863864987*^9, 
   3.663781865523129*^9}, {3.6675556965369053`*^9, 3.667555699897505*^9}, {
   3.6675557701971416`*^9, 3.667555805627221*^9}, 3.6675559565740623`*^9, {
   3.6675560123684196`*^9, 3.66755604360882*^9}, {3.667556115980192*^9, 
   3.667556122118576*^9}, {3.6675561584051437`*^9, 3.667556188424618*^9}, {
   3.6679974439410133`*^9, 3.667997445190381*^9}, {3.667997485649564*^9, 
   3.667997575306632*^9}, {3.6679976316612043`*^9, 3.667997661453814*^9}, {
   3.667997742725563*^9, 3.6679978582501717`*^9}, {3.667997900060019*^9, 
   3.667997917423407*^9}, 3.668098773946547*^9, {3.669524509050913*^9, 
   3.6695245091603203`*^9}, {3.669524629332117*^9, 3.669524739324606*^9}, 
   3.669524790829796*^9, {3.669567494469973*^9, 3.669567504687673*^9}, {
   3.669567541533555*^9, 3.669567666306954*^9}, 3.6695684265816917`*^9, {
   3.669569651761203*^9, 3.669569654382758*^9}, {3.6696145307538652`*^9, 
   3.6696145313886013`*^9}, {3.669614568097046*^9, 3.669614672381241*^9}, 
   3.6696149509366703`*^9, {3.669624852031321*^9, 3.669624892287318*^9}, {
   3.670128150984276*^9, 3.67012815123835*^9}, 3.671009577371149*^9, 
   3.671011517740581*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6636748335547333`*^9, 3.66367484688381*^9}, 
   3.66367489322965*^9, {3.6636751390419197`*^9, 3.663675152606451*^9}, 
   3.663680390110241*^9, {3.663768846879314*^9, 3.6637688540002403`*^9}, 
   3.663781316780634*^9, 3.663781596671937*^9, 3.663781675071645*^9, 
   3.66378190821101*^9, 3.6637856941225777`*^9, 3.6639665546322613`*^9, 
   3.6648635877674103`*^9, 3.667555701510091*^9, {3.66755578099391*^9, 
   3.667555785904827*^9}, 3.6675559571734247`*^9, 3.667556012751246*^9, 
   3.667556044007701*^9, 3.667556122485395*^9, {3.667556159630086*^9, 
   3.667556189089692*^9}, 3.667727226328364*^9, {3.6679975525294724`*^9, 
   3.667997576052685*^9}, {3.667997658293898*^9, 3.667997661813695*^9}, {
   3.667997743329747*^9, 3.667997858552108*^9}, 3.6679979178015547`*^9, 
   3.66800434499222*^9, 3.6680559909266768`*^9, 3.668057124593375*^9, 
   3.668098663810004*^9, 3.668098774358718*^9, 3.669524517022687*^9, {
   3.669524631691203*^9, 3.669524686712611*^9}, 3.669524739797134*^9, 
   3.669524791995308*^9, {3.669567505768709*^9, 3.6695675621330853`*^9}, {
   3.669567604089307*^9, 3.669567667061729*^9}, 3.669568427139906*^9, 
   3.6695696548397617`*^9, 3.6696095201187067`*^9, 3.669613750968424*^9, 
   3.6696145317886066`*^9, {3.669614571156706*^9, 3.669614673644081*^9}, {
   3.669624894116621*^9, 3.669624896898871*^9}, 3.6710089352857924`*^9, 
   3.671033795574732*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6636748335547333`*^9, 3.66367484688381*^9}, 
   3.66367489322965*^9, {3.6636751390419197`*^9, 3.663675152606451*^9}, 
   3.663680390110241*^9, {3.663768846879314*^9, 3.6637688540002403`*^9}, 
   3.663781316780634*^9, 3.663781596671937*^9, 3.663781675071645*^9, 
   3.66378190821101*^9, 3.6637856941225777`*^9, 3.6639665546322613`*^9, 
   3.6648635877674103`*^9, 3.667555701510091*^9, {3.66755578099391*^9, 
   3.667555785904827*^9}, 3.6675559571734247`*^9, 3.667556012751246*^9, 
   3.667556044007701*^9, 3.667556122485395*^9, {3.667556159630086*^9, 
   3.667556189089692*^9}, 3.667727226328364*^9, {3.6679975525294724`*^9, 
   3.667997576052685*^9}, {3.667997658293898*^9, 3.667997661813695*^9}, {
   3.667997743329747*^9, 3.667997858552108*^9}, 3.6679979178015547`*^9, 
   3.66800434499222*^9, 3.6680559909266768`*^9, 3.668057124593375*^9, 
   3.668098663810004*^9, 3.668098774358718*^9, 3.669524517022687*^9, {
   3.669524631691203*^9, 3.669524686712611*^9}, 3.669524739797134*^9, 
   3.669524791995308*^9, {3.669567505768709*^9, 3.6695675621330853`*^9}, {
   3.669567604089307*^9, 3.669567667061729*^9}, 3.669568427139906*^9, 
   3.6695696548397617`*^9, 3.6696095201187067`*^9, 3.669613750968424*^9, 
   3.6696145317886066`*^9, {3.669614571156706*^9, 3.669614673644081*^9}, {
   3.669624894116621*^9, 3.669624896898871*^9}, 3.6710089352857924`*^9, 
   3.671033795726*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fermion: expansion operators", "Subsection",
 CellChangeTimes->{{3.4535844404117928`*^9, 3.4535844415037603`*^9}, 
   3.643047313599284*^9, {3.6430478198430023`*^9, 3.643047838586029*^9}, {
   3.644793368090185*^9, 3.6447933743295317`*^9}, {3.6447934424755917`*^9, 
   3.6447935130696793`*^9}, {3.646369490692437*^9, 3.646369494542533*^9}, 
   3.646466457334859*^9, {3.6464670754941463`*^9, 3.646467165301708*^9}, {
   3.6625746424641247`*^9, 3.662574647009775*^9}, {3.662706095187007*^9, 
   3.662706131059403*^9}, {3.663782135208894*^9, 3.663782173197812*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Sigma]1", ",", "\[Sigma]2", ",", "\[Sigma]3"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], 
          FractionBox[
           RowBox[{"JacobiCN", "[", 
            RowBox[{"\[Sigma]", ",", 
             SuperscriptBox["k", "2"]}], "]"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["k", "2"]}]]], 
          RowBox[{"(", 
           RowBox[{"d\[Sigma]", "+", 
            FractionBox[
             RowBox[{
              RowBox[{"JacobiSN", "[", 
               RowBox[{"\[Sigma]", ",", 
                SuperscriptBox["k", "2"]}], "]"}], 
              RowBox[{"JacobiDN", "[", 
               RowBox[{"\[Sigma]", ",", 
                SuperscriptBox["k", "2"]}], "]"}]}], 
             RowBox[{"2", 
              RowBox[{"JacobiCN", "[", 
               RowBox[{"\[Sigma]", ",", 
                SuperscriptBox["k", "2"]}], "]"}]}]]}], ")"}], "\[Sigma]1"}], 
         "-", 
         RowBox[{"\[ImaginaryI]", 
          FractionBox[
           RowBox[{"JacobiCN", "[", 
            RowBox[{"\[Sigma]", ",", 
             SuperscriptBox["k", "2"]}], "]"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["k", "2"]}]]], "\[Sigma]2", " ", "d\[Tau]"}], "+",
          "\[Sigma]3"}], "/.", "sub"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"JacobiCN", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"EllipticK", "[", 
                SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
            SuperscriptBox["k", "2"]}], "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "r", "]"}], "-", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", "r", "]"}], "2"], 
               RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{"unknown1", " ", 
             SuperscriptBox["k", "4"]}]}], ")"}]}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"JacobiCN", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"EllipticK", "[", 
                 SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
             SuperscriptBox["k", "2"]}], "]"}], 
           RowBox[{"-", "1"}]], "\[Rule]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", "r", "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Sin", "[", "r", "]"}], "2"], 
                RowBox[{"Cos", "[", "r", "]"}]}], "4"], 
              SuperscriptBox["k", "2"]}], "+", 
             RowBox[{"unknown1", " ", 
              SuperscriptBox["k", "4"]}]}], ")"}], 
           RowBox[{"-", "1"}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"JacobiSN", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"EllipticK", "[", 
                 SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
             SuperscriptBox["k", "2"]}], "]"}], 
           RowBox[{"JacobiDN", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"EllipticK", "[", 
                 SuperscriptBox["k", "2"], "]"}]}], "\[Pi]"], "r"}], ",", 
             SuperscriptBox["k", "2"]}], "]"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sin", "[", "r", "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"Sin", "[", "r", "]"}], 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "r", "]"}], "2"]}], "4"], " ", 
              SuperscriptBox["k", "2"]}], "+", 
             RowBox[{"unknown2", " ", 
              SuperscriptBox["k", "4"]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox[
               SuperscriptBox[
                RowBox[{"Sin", "[", "r", "]"}], "2"], "2"], " ", 
              SuperscriptBox["k", "2"]}], "+", 
             RowBox[{"unknown3", " ", 
              SuperscriptBox["k", "4"]}]}], ")"}]}]}]}], "}"}]}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], "&"}]}], "//", 
     "PowerExpand"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"tmp", ",", "0"}], "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "  ", "Dbar"}], "+", "\[Sigma]3"}]}], "//",
     "FullSimplify"}], "//", "Expand"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"tmp", ",", "2"}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "r", "]"}], "3"]}], "4"]}], " ", "\[Sigma]1", 
     " ", "dr"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"3", " ", "r"}], "]"}], "-", 
         RowBox[{"9", " ", 
          RowBox[{"Cos", "[", "r", "]"}]}]}], ")"}]}], "16"], " ", 
     "\[Sigma]2", " ", "dw"}], " ", "-", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", "r", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "r", "]"}], "2"]}], "8"], " ", "\[Sigma]1"}]}]}], 
  "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6636758756332808`*^9, 3.663675924724959*^9}, {
   3.663676099536675*^9, 3.663676166310309*^9}, {3.66367670635585*^9, 
   3.6636767637904177`*^9}, {3.663676908978339*^9, 3.663676917542625*^9}, {
   3.66367706404788*^9, 3.6636770649851847`*^9}, {3.663678421850121*^9, 
   3.663678422020862*^9}, {3.6636784575474663`*^9, 3.663678475196128*^9}, {
   3.6636785841900387`*^9, 3.663678681948433*^9}, {3.6636787282913094`*^9, 
   3.663678754971513*^9}, {3.663678988896772*^9, 3.6636790231259623`*^9}, {
   3.663681753963957*^9, 3.663681797520184*^9}, {3.663681933697937*^9, 
   3.663681935042921*^9}, 3.663681973811473*^9, {3.663682077780695*^9, 
   3.663682082194475*^9}, 3.663682743620805*^9, {3.663682795629323*^9, 
   3.663682797217586*^9}, {3.66368285695947*^9, 3.663682923064418*^9}, {
   3.6636829534129333`*^9, 3.663683009538637*^9}, {3.6636830484253817`*^9, 
   3.6636830485691137`*^9}, {3.663683165121492*^9, 3.663683166580166*^9}, {
   3.663683786863017*^9, 3.66368378979495*^9}, {3.6636840732471952`*^9, 
   3.663684152424189*^9}, {3.6636842118199377`*^9, 3.663684237134972*^9}, {
   3.663755635843898*^9, 3.663755640909956*^9}, {3.663769085034172*^9, 
   3.663769090435718*^9}, {3.663769153719511*^9, 3.6637691816313334`*^9}, {
   3.6637692161477003`*^9, 3.663769247204805*^9}, {3.663769278044807*^9, 
   3.663769314832487*^9}, {3.6637693481485567`*^9, 3.663769411453323*^9}, {
   3.663769486611957*^9, 3.663769487158453*^9}, {3.663769529378035*^9, 
   3.663769530052343*^9}, {3.6637695654728537`*^9, 3.663769568494426*^9}, {
   3.663781485913875*^9, 3.663781518014921*^9}, {3.663781649795411*^9, 
   3.6637816614250526`*^9}, {3.6637818216357327`*^9, 
   3.6637818216519537`*^9}, {3.663781878290019*^9, 3.663781885374846*^9}, {
   3.663785679312907*^9, 3.6637856913383102`*^9}, {3.6640403975480957`*^9, 
   3.6640403979812117`*^9}, {3.667559462519306*^9, 3.66755946977598*^9}, {
   3.667559514945745*^9, 3.667559531987321*^9}, {3.667559609167899*^9, 
   3.667559629876522*^9}, 3.667560141345049*^9, {3.6675601808605957`*^9, 
   3.667560190787195*^9}, 3.6675602570189743`*^9, 3.667560462707449*^9, {
   3.667561221141083*^9, 3.6675612212926493`*^9}, {3.667561367978652*^9, 
   3.667561380057765*^9}, {3.6675614176278543`*^9, 3.667561418648511*^9}, {
   3.667561458660337*^9, 3.667561459531684*^9}, {3.667561537762973*^9, 
   3.667561538011993*^9}, {3.66756160993535*^9, 3.6675616278222446`*^9}, 
   3.667561672236876*^9, 3.6675619542483788`*^9, {3.6675619938622513`*^9, 
   3.66756199501847*^9}, 3.667562229851706*^9, 3.667562481812726*^9, {
   3.667562554632371*^9, 3.6675625554916067`*^9}, {3.667562640382126*^9, 
   3.667562641664308*^9}, {3.667563065984365*^9, 3.667563069462995*^9}, {
   3.667563210572443*^9, 3.667563216076543*^9}, {3.667563342456321*^9, 
   3.667563350279683*^9}, 3.667563769248053*^9, {3.66756381445639*^9, 
   3.667563831387886*^9}, {3.6675638817486067`*^9, 3.667563888270247*^9}, 
   3.6675640216104307`*^9, {3.667564828730048*^9, 3.667564834772785*^9}, {
   3.66756540680654*^9, 3.667565452114875*^9}, 3.667565549149392*^9, {
   3.667565580240549*^9, 3.667565604800015*^9}, {3.6675656466017923`*^9, 
   3.667565657652657*^9}, {3.667565741016335*^9, 3.667565743097909*^9}, {
   3.667565823064086*^9, 3.667565835476192*^9}, {3.667565878259098*^9, 
   3.6675658804062977`*^9}, {3.6675659322434998`*^9, 3.667565950066279*^9}, {
   3.667566013200521*^9, 3.667566053756359*^9}, {3.667566206636653*^9, 
   3.667566222293748*^9}, {3.667998102780302*^9, 3.667998254040106*^9}, {
   3.66800033033941*^9, 3.668000332278537*^9}, {3.6680043550572844`*^9, 
   3.668004408205023*^9}, {3.668005736414001*^9, 3.668005746356821*^9}, {
   3.6680057873603897`*^9, 3.668005798807838*^9}, {3.668057130987176*^9, 
   3.668057172895166*^9}, 3.6680572110029793`*^9, {3.668057421369413*^9, 
   3.6680574402517242`*^9}, {3.668057520668334*^9, 3.668057588264539*^9}, {
   3.6680576224073277`*^9, 3.668057728243477*^9}, {3.6680577836170263`*^9, 
   3.668057785289557*^9}, {3.668058539337785*^9, 3.6680586102684507`*^9}, {
   3.668058655539589*^9, 3.6680586763257513`*^9}, {3.668098640771337*^9, 
   3.6680986564677896`*^9}, {3.669524818808599*^9, 3.6695248458009644`*^9}, {
   3.669524880784807*^9, 3.6695249494101553`*^9}, {3.669525008557087*^9, 
   3.669525013019182*^9}, {3.669525045860332*^9, 3.669525113295145*^9}, {
   3.669525372187996*^9, 3.669525377472411*^9}, {3.6695254740750723`*^9, 
   3.669525483199009*^9}, {3.669525678050263*^9, 3.669525682652773*^9}, {
   3.66952572547057*^9, 3.6695258444810762`*^9}, {3.669525919979075*^9, 
   3.669525963400009*^9}, {3.669569680388556*^9, 3.669569684276684*^9}, {
   3.66957131047372*^9, 3.6695715684482317`*^9}, {3.669571710326144*^9, 
   3.669571738014641*^9}, {3.669571822601465*^9, 3.6695718247455473`*^9}, 
   3.669609510431233*^9, 3.670128158731784*^9, {3.6710095862993507`*^9, 
   3.671009609566378*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.669524846236248*^9, {3.669525469976071*^9, 3.6695254866501093`*^9}, 
   3.669525683001964*^9, 3.669525729420315*^9, {3.6695257845850067`*^9, 
   3.669525844840788*^9}, {3.669525926453165*^9, 3.669525963870015*^9}, 
   3.66956969024368*^9, {3.6695713916887693`*^9, 3.669571519924964*^9}, {
   3.6695715551327763`*^9, 3.6695715688590384`*^9}, 3.6695717407531967`*^9, 
   3.669571825057621*^9, {3.669609512977785*^9, 3.669609520326981*^9}, 
   3.6696137512553988`*^9, 3.669615707266281*^9, 3.669624897164834*^9, 
   3.671008935590274*^9, 3.671011779003234*^9, 3.6710337959902353`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.669524846236248*^9, {3.669525469976071*^9, 3.6695254866501093`*^9}, 
   3.669525683001964*^9, 3.669525729420315*^9, {3.6695257845850067`*^9, 
   3.669525844840788*^9}, {3.669525926453165*^9, 3.669525963870015*^9}, 
   3.66956969024368*^9, {3.6695713916887693`*^9, 3.669571519924964*^9}, {
   3.6695715551327763`*^9, 3.6695715688590384`*^9}, 3.6695717407531967`*^9, 
   3.669571825057621*^9, {3.669609512977785*^9, 3.669609520326981*^9}, 
   3.6696137512553988`*^9, 3.669615707266281*^9, 3.669624897164834*^9, 
   3.671008935590274*^9, 3.671011779003234*^9, 3.671033796187739*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{782, 723},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 5471, 134, 486, "Input"],
Cell[CellGroupData[{
Cell[5896, 151, 580, 8, 44, "Subsection"],
Cell[CellGroupData[{
Cell[6501, 163, 7809, 201, 578, "Input"],
Cell[14313, 366, 1400, 19, 28, "Output"],
Cell[15716, 387, 1400, 19, 28, "Output"],
Cell[17119, 408, 1402, 19, 28, "Output"],
Cell[18524, 429, 1400, 19, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19973, 454, 621, 8, 44, "Subsection"],
Cell[CellGroupData[{
Cell[20619, 466, 5462, 115, 300, "Input"],
Cell[26084, 583, 1013, 14, 28, "Output"],
Cell[27100, 599, 1011, 14, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28148, 618, 3151, 85, 283, "Input"],
Cell[31302, 705, 369, 5, 28, "Output"],
Cell[31674, 712, 369, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32080, 722, 4828, 116, 283, "Input"],
Cell[36911, 840, 1432, 20, 28, "Output"],
Cell[38346, 862, 1429, 20, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39824, 888, 568, 7, 44, "Subsection"],
Cell[CellGroupData[{
Cell[40417, 899, 11221, 247, 512, "Input"],
Cell[51641, 1148, 637, 9, 28, "Output"],
Cell[52281, 1159, 635, 9, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

